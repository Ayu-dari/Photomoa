<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #EADDDD;">
  <div class="container">
    <a class="navbar-brand fw-bold d-flex align-items-center" href="<%= root_path %>" style="color: #EC69EC;">
      <%= image_tag 'photomoa_cat.png', alt: 'Photomoa', width: 30, height: 30, class: 'd-inline-block align-text-top me-2' %>
      Photomoa
    </a>

    <!-- ハンバーガーメニューのトグルボタン -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" data-turbo="false">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- 折りたたむメニューの中身 -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><%= link_to "プロフィール編集", edit_user_registration_path, class: "nav-link" %></li>
        <% if user_signed_in? %>
    <div class="text-end me-3 mt-3">
      <%= button_to "ログアウト", destroy_user_session_path,
            method: :delete,
            data: { confirm: "本当にログアウトしますか？" },
            class: "btn btn-outline-danger btn-sm" %>
    </div>
  <% end %>
      </ul>
    </div>
  </div>
</nav>

<div class="text-center my-4">
  <% if current_user.avatar.attached? %>
    <%= image_tag current_user.avatar.variant(resize_to_fill: [100, 100]), class: "rounded-circle border border-2", alt: "ユーザーアイコン" %>
  <% else %>
    <%= image_tag "default_user.png", width: 100, height: 100, class: "rounded-circle border border-2", alt: "デフォルトアイコン" %>
  <% end %>
</div>

<!-- ユーザー名表示 -->
<div class="text-center my-4">
  <p class="mt-2 fw-bold"><%= current_user.name %></p>
</div>

<!-- ボタンエリア -->
<div class="text-center mt-3">
  <%= link_to "投稿する", new_post_path, class: "btn btn-success text-white mx-2" %>
  <%= link_to "投稿を検索する", posts_path, class: "btn btn-info text-white mx-2" %>
</div>

<div class="container my-4">
  <!-- Nav tabs -->
  <ul class="nav nav-tabs justify-content-center" id="mypageTabs" role="tablist" style="width: 100%;">
    <li class="nav-item text-center flex-fill" role="presentation">
      <button class="nav-link active w-100" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts" type="button" role="tab" aria-controls="posts" aria-selected="true"
        style="background-color: #D1C588; color: #FFFFFF; font-weight: bold;">
        最新投稿一覧
      </button>
    </li>
    <li class="nav-item text-center flex-fill" role="presentation">
      <button class="nav-link w-100" id="favorites-tab" data-bs-toggle="tab" data-bs-target="#favorites" type="button" role="tab" aria-controls="favorites" aria-selected="false"
        style="background-color: #DDD4EE; color: #FFFFFF; font-weight: bold;">
        お気に入り
      </button>
    </li>
  </ul>
</div>



  <!-- Tab panes -->
  <div class="tab-content mt-3" id="mypageTabsContent">
    <!-- 最新投稿一覧 -->
<div class="tab-pane fade show active" id="posts" role="tabpanel" aria-labelledby="posts-tab"
     style="background-color: #FFF6E5; padding: 20px; border-radius: 10px;">
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
    <% if @posts.present? %>
      <% @posts.each do |post| %>
        <div class="col">
          <div class="card h-100 shadow-sm">
            <% if post.image.attached? %>
              <%= image_tag post.image, class: "card-img-top", style: "height: 200px; object-fit: cover;" %>
            <% else %>
              <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
                <i class="bi bi-image fs-1 text-muted"></i>
              </div>
            <% end %>

            <div class="card-body">
              <h5 class="card-title fw-bold"><%= post.title %></h5>
              <p class="card-text"><%= simple_format(post.body) %></p>
              <p class="card-text text-muted">📍 <%= post.location.presence || "未設定" %></p>

              <% if post.tags.present? %>
                <div class="mb-2">
                  <% post.tags.each do |tag| %>
                    <span class="badge bg-secondary">#<%= tag.name %></span>
                  <% end %>
                </div>
              <% end %>
            </div>

            <div class="card-footer d-flex justify-content-between align-items-center">
              <div>
                <%= link_to edit_post_path(post), class: "text-decoration-none me-2 text-dark" do %>
                  <i class="bi bi-pencil"></i> 編集
                <% end %>
                <%= link_to post_path(post), method: :delete, data: { confirm: "削除してもよろしいですか？" }, class: "text-danger text-decoration-none" do %>
                  <i class="bi bi-trash"></i> 削除
                <% end %>
              </div>
              <small class="text-muted"><%= post.created_at.strftime("%Y/%m/%d") %></small>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <p class="p-3 rounded text-center" style="background-color: #FFEFD5;">
        投稿がまだありません。
      </p>
    <% end %>
  </div>
</div>


    <!-- お気に入り -->
    <div class="tab-pane fade" id="favorites" role="tabpanel" aria-labelledby="favorites-tab"
     style="background-color: #F3EAFB; padding: 20px; border-radius: 10px;">
  <div class="post-cards">
    <% if @favorites.present? %>
      <% @favorites.each do |post| %>
        <div class="post-card">
          <%= image_tag(post.image, alt: "お気に入り画像") %>
          <h4><%= post.title %></h4>
        </div>
      <% end %>
    <% else %>
      <p class="p-3 rounded text-center" style="background-color: #FBEAFF;">
        お気に入りがまだありません。
      </p>
    <% end %>
  </div>
</div>
  </div>
</div>

<body class="d-flex flex-column min-vh-100">
  <%= yield %>

  <footer class="mt-auto text-center py-4" style="background-color: #615050; color: #fff;">
    <div class="container">
      <a href="#" class="text-white text-decoration-underline me-3">利用規約</a>
      <a href="#" class="text-white text-decoration-underline">プライバシーポリシー</a>
      <p class="mt-3 mb-0">© 2025 Photomoa. All rights reserved.</p>
    </div>
  </footer>
</body>